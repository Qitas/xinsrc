
.. _cortex_m4:

Cortex-M4
====================

:ref:`performance` : ``2.19 CoreMark/MHz`` ``1.25 DMIPS/MHz``

.. contents::
    :local:

.. note::
    由ARM专门开发的最新嵌入式处理器，在M3的基础上强化了运算能力，新加了浮点、DSP、并行计算等，用以满足需要有效且易于使用的控制和信号处理功能混合的数字信号控制市场。


简介
----------

ARMCortex™-M4处理器内核是在Cortex-M3内核基础上发展起来的，其性能比Cortex-M3提高了20%。新增加了浮点、DSP、并行计算等。用以满足需要有效且易于使用的控制和信号处理功能混合的数字信号控制市场。其高效的信号处理功能与Cortex-M处理器系列的低功耗、低成本和易于使用的优点相结合。
Cortex-M4提供了无可比拟的功能，将32位控制与领先的数字信号处理技术集成来满足需要很高能效级别的市场。
Cortex-M4处理器采用一个扩展的单时钟周期乘法累加（MAC）单元、优化的单指令多数据（SIMD）指令、饱和运算指令和一个可选的单精度浮点单元（FPU)。

优势
~~~~~~~~~

* 低功耗：都低于200uA/MHz。
* 高性能：3 CoreMark/MHz
* 高能耗效率：功耗低，性能高所以具有高能耗效率。
* 良好的代码密度：Thumb ISA指令架构，在完成相同任务时，所需程序代码更少。
* 中断多数量，多优先级，实时性好：240个向量中断，8~256中断优先级，中断等待12个周期（中断嵌套由硬件自动处理）。
* 易于使用：具有简单、线性的存储器。
* 可扩展性强：低端处理器，到200MHz高端处理器。
* 调试特性丰富：标准调试特性（单步，暂停等），捕获程序流、数据变动以及概况信息等跟踪数据。还可以多Cortex-M处理器共享调试连接。
* 多种OS支持，超过30余种。
* 多种系统特性，例如：可位寻址存储器区域（位段特性）和MPU（存储器保护单元）。
* 软件可移植性、可重用性：C友好架构，CMSIS。


对比
---------

 :ref:`cortex_m3` 与 :ref:`cortex_m4` 处理器均使用32位架构，寄存器组中的内部寄存器、数据通路以及总线接口都是32位。Cortex-M处理器使用的指令集架构（ISA）为Thumb ISA，基于Thumb-2技术并同时支持16位和32位指令。

相同点
~~~~~~~~~

* 基于ARM-v7-M架构。三级流水线设计。哈佛总线架构，统一的存储器空间：指令和地址总线使用相同的地址空间。
* 32位寻址，支持4GB 存储空间。
* 基于ARM AMBA（高级微控制器总线架构）技术的片上接口，支持高吞吐量的流水线总线操作。
* NVIC（嵌套向量中断控制器），最多支持240个中断请求和8~256个中断优先级（理论上支持，实际需芯片厂商设计）
* 具有支持多种OS（操作系统）特性，例如：节拍定时器和影子栈指针等。
* 支持休眠模式和多种低功耗模式。
* 支持可选MPU（存储器保护单元），具有存储器保护特性：可编程存储器或访问权限控制等。
* 可通过位段特性支持两个特定存储器区域中的位数据访问。
* 可选择使用单个或多个处理器。

不同点
~~~~~~~~~

* Cortex-M4在DSP方面应用具有更高的性能。
* Cortex-M4支持浮点运算（单精度）。
* Cortex-M4支持单指令多数据（SIMD）操作。
* Cortex-M4支持快速MAC和乘法指令。
* Cortex-M4支持饱和运算指令。


产品
---------
.. toctree::
    :maxdepth: 1

    HC32F460 <../M/HC32F460>
